<!DOCTYPE html>
<html>
<head>
    <title>Login Page</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="../static/style/style.css">
</head>
<body class="dark-mode">

    <div class="container-fluid h-100">
        <div class="row h-100 justify-content-center align-items-center">
            <div class="col-md-6">

                <p id="dark_p" onclick=toggle() class="text-danger text-right mt-5 mb-1 small">Dark Mode</p>
                <div class="mt-0 form-group text-right">
                    <div class="custom-control switch" id="switchDiv">
                        <p id="switch"></p>
                    </div>
                </div>
                
                <div class="text-center">
                    <img src="../static/images/aNightAtLancasters.png" class="img-fluid mb-3" alt="Lancaster Logo">
                </div>

                <form action="/login" method="post">

                    {% with messages = get_flashed_messages(category_filter=['login']) %}
                        {% if messages %}
                            <div class="alert alert-danger" role="alert">
                                <strong><u>Login Error:</u></strong>
                                {% for message in messages %}
                                    <p class="mt-2"> {{message}}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    {% endwith %}

                    <div class="form-group">
                        <label for="login_username" class="text-danger">Username</label>
                        <input type="text" class="form-control" name="login_username" id="login_username" placeholder="Enter username">
                    </div>
                    <div class="form-group">
                        <label for="login_password" class="text-danger">Password</label>
                        <input type="password" class="form-control" name="login_password" id="login_password" placeholder="Enter password">
                    </div>
                    <button type="submit" value="Enter" class="my-4 btn btn-danger btn-block">Login</button>
                </form>

            </div>
        </div>
    </div>

    <script>
        let switchBtn = document.querySelector("#switch");
        const body = document.querySelector("body");
        const html = document.querySelector("html");

        switchBtn.addEventListener("change", (event) => {
            if(event.target.checked){
                body.classList.remove("light-mode");
                body.classList.add("dark-mode");
                html.classList.add("dark-mode");
            } else {
                body.classList.remove("dark-mode");
                body.classList.add("light-mode");
                html.classList.remove("dark-mode");
            }
        });

        function toggle(){

            let switchToggle

            document.getElementById("switchDiv").innerHTML.length <= 65 ? 
                switchToggle = true : 
                switchToggle = false

            if(switchToggle){

                if(body.classList.contains("light-mode")){
                    body.classList.remove("light-mode");
                    body.classList.add("dark-mode");
                    html.classList.add("dark-mode");
                }
                    
                document.getElementById("switchDiv").innerHTML = 
                `
                    <input type="checkbox" class="custom-control-input switch" id="switch" name="switch" checked/>
                    <label class="form control custom-control-label text-danger" for="switch"></label>
                `
            } else {
                document.getElementById("switchDiv").innerHTML = `<p id="switch"></p>`
            }

            switchBtn = document.querySelector("#switch");

            switchBtn.addEventListener("change", (event) => {
                if(event.target.checked){
                    body.classList.remove("light-mode");
                    body.classList.add("dark-mode");
                    html.classList.add("dark-mode");
                } else {
                    body.classList.remove("dark-mode");
                    body.classList.add("light-mode");
                    html.classList.remove("dark-mode");
                }
            });
        }

        function clearForm(){
            document.getElementById("regForm").reset();
        }

    </script>

</body>
</html>
